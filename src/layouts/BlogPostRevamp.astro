---
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import FormattedDate from "../components/FormattedDate.astro";
import { SITE_URL } from "../consts";

type Props = {
  title: string;
  description: string;
  pubDate: Date;
  updatedDate?: Date;
  heroImage?: string;
};

const { title, description, pubDate, updatedDate, heroImage } =
  Astro.props as Props;
const postPath = Astro.url.pathname.endsWith("/")
  ? Astro.url.pathname
  : `${Astro.url.pathname}/`;
const postUrl = new URL(postPath, SITE_URL).toString();
const jsonLd = {
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  headline: title,
  description,
  datePublished: pubDate.toISOString(),
  ...(updatedDate ? { dateModified: updatedDate.toISOString() } : {}),
  ...(heroImage ? { image: new URL(heroImage, SITE_URL).toString() } : {}),
  author: {
    "@type": "Organization",
    name: "moldovawebsite.md",
    url: SITE_URL,
  },
  publisher: {
    "@type": "Organization",
    name: "moldovawebsite.md",
    url: SITE_URL,
  },
  mainEntityOfPage: { "@type": "WebPage", "@id": postUrl },
};
---

<html lang="ro">
  <head>
    <BaseHead
      title={title}
      description={description}
      canonicalUrl={postUrl}
      jsonLd={jsonLd}
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Fraunces:wght@500;700;800&family=Manrope:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      .blog-revamp {
        background: var(--bg);
        color: var(--fg);
        font-family: var(--font-body);
      }

      .blog-revamp main {
        padding: 100px 0 60px;
      }

      .story-shell {
        width: min(1100px, calc(100% - 2rem));
        margin: 0 auto;
        display: grid;
        gap: 3rem;
      }

      .story-hero {
        display: grid;
        gap: 2.5rem;
        align-items: center;
      }

      .hero-media {
        position: relative;
        border-radius: var(--radius-3);
        overflow: hidden;
        box-shadow: var(--shadow-2);
        background: var(--surface);
      }

      .hero-media img {
        display: block;
        width: 100%;
        height: auto;
      }

      .hero-copy {
        display: grid;
        gap: 1.5rem;
      }

      .meta-row {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
      }

      .meta-pill {
        padding: 0.5rem 1rem;
        border-radius: 999px;
        background: var(--bg);
        color: var(--muted);
        font-size: var(--step--1);
        font-weight: 600;
        border: 1px solid var(--border);
      }

      .story-title {
        margin: 0;
        font-family: var(--font-heading);
        font-size: clamp(var(--step-4), 4vw, var(--step-5));
        font-weight: 800;
        letter-spacing: -0.02em;
        line-height: 1.1;
        color: var(--brand-1);
      }

      .story-body {
        display: grid;
        gap: 3rem;
      }

      .story-body p {
        font-size: var(--step-0);
        line-height: 1.7;
      }

      .story-body h2,
      .story-body h3 {
        font-family: var(--font-heading);
        color: var(--brand-1);
      }

      .story-body h2 {
        font-size: var(--step-3);
        margin-top: 2rem;
        margin-bottom: 1rem;
      }

      .story-body h3 {
        font-size: var(--step-2);
        margin-top: 1.5rem;
        margin-bottom: 0.75rem;
      }

      .story-body ul,
      .story-body ol {
        padding-left: 1.5rem;
      }

      .story-body li {
        margin-bottom: 0.5rem;
      }

      .content-block {
        background: var(--surface);
        border-radius: var(--radius-2);
        padding: 2.5rem;
        border: 1px solid var(--border);
        box-shadow: var(--shadow-1);
        display: grid;
        gap: 2rem;
      }

      .block-header {
        display: grid;
        gap: 0.5rem;
      }

      .block-kicker {
        text-transform: uppercase;
        letter-spacing: 0.1em;
        font-size: var(--step--1);
        font-weight: 700;
        color: var(--brand-2);
      }

      .block-title {
        margin: 0;
        font-size: var(--step-3);
        color: var(--brand-1);
      }

      .text-card {
        background: var(--surface);
        border-radius: var(--radius-2);
        padding: 1.75rem;
        border: 1px solid var(--border);
        box-shadow: var(--shadow-1);
      }

      .text-card.is-lead {
        background: var(--bg);
        border-left: 4px solid var(--brand-2);
        font-size: var(--step-0);
      }

      .card-grid {
        display: grid;
        gap: 1.5rem;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      }

      .stat-card {
        background: var(--bg);
        border-radius: var(--radius-2);
        padding: 1.5rem;
        border: 1px solid var(--border);
        font-weight: 600;
      }

      .stat-card strong {
        display: block;
        font-size: var(--step-1);
        margin-bottom: 0.5rem;
        font-family: var(--font-heading);
        color: var(--brand-1);
      }

      .table-card {
        border-radius: var(--radius-2);
        background: var(--surface);
        border: 1px solid var(--border);
        overflow: hidden;
      }

      .table-card table {
        width: 100%;
        border-collapse: collapse;
      }

      .table-card th,
      .table-card td {
        padding: 1rem 1.5rem;
        border-bottom: 1px solid var(--border);
        text-align: left;
      }

      .table-card thead {
        background: var(--bg);
      }

      .callout-card {
        background: color-mix(in oklch, var(--brand-2) 10%, transparent);
        border-radius: var(--radius-2);
        padding: 1.5rem;
        border: 1px solid color-mix(in oklch, var(--brand-2) 30%, transparent);
      }

      .checklist {
        display: grid;
        gap: 1rem;
        padding-left: 0;
        list-style: none;
      }

      .checklist li {
        padding: 1rem;
        border-radius: var(--radius-1);
        background: var(--bg);
        border: 1px solid var(--border);
      }

      .company-card {
        background: var(--surface);
        border-radius: var(--radius-2);
        padding: 2.5rem;
        border: 1px solid var(--border);
        box-shadow: var(--shadow-1);
        display: grid;
        gap: 2rem;
        transition:
          box-shadow 0.2s ease,
          transform 0.2s ease;
      }

      .company-card:hover {
        box-shadow: var(--shadow-2);
        transform: translateY(-2px);
      }

      .company-header {
        display: flex;
        align-items: center;
        gap: 1.5rem;
      }

      .company-rank {
        width: 56px;
        height: 56px;
        border-radius: 50%;
        display: grid;
        place-items: center;
        background: var(--brand-1);
        color: #fff;
        font-weight: 800;
        font-size: var(--step-1);
        flex-shrink: 0;
      }

      .company-header h2 {
        margin: 0;
        font-size: var(--step-3);
        color: var(--brand-1);
      }

      .company-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        align-items: center;
      }

      .company-link {
        font-weight: 700;
        text-decoration: none;
        color: var(--brand-1);
        border-bottom: 2px solid var(--brand-2);
      }

      .company-link:hover {
        color: var(--brand-2);
      }

      .pill {
        font-size: var(--step--1);
        font-weight: 600;
        padding: 0.4rem 0.8rem;
        border-radius: 999px;
        background: var(--bg);
        color: var(--muted);
        border: 1px solid var(--border);
      }

      .company-grid {
        display: grid;
        gap: 2rem;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      }

      .quick-choice {
        list-style: none;
        padding-left: 0;
        display: grid;
        gap: 1rem;
      }

      .quick-choice li {
        background: var(--bg);
        border: 1px solid var(--border);
        padding: 1.25rem;
        border-radius: var(--radius-1);
        transition: background 0.2s ease;
      }

      .quick-choice li:hover {
        background: color-mix(in oklch, var(--brand-1) 5%, transparent);
      }

      .quick-choice strong {
        color: var(--brand-1);
      }

      .quick-choice a {
        color: var(--brand-2);
        text-decoration: none;
        font-weight: 600;
      }

      .quick-choice a:hover {
        text-decoration: underline;
      }

      @media (min-width: 920px) {
        .story-hero {
          grid-template-columns: 1fr 1fr;
          gap: 4rem;
        }

        .hero-media {
          order: 2;
        }
      }

      @media (max-width: 768px) {
        .story-shell {
          width: min(100%, calc(100% - 1.5rem));
          gap: 2.5rem;
        }

        .content-block {
          padding: 2rem;
        }

        .text-card {
          padding: 1.5rem;
        }

        .company-card {
          padding: 2rem;
        }

        .company-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 1rem;
        }

        .company-rank {
          width: 48px;
          height: 48px;
          font-size: var(--step-0);
        }

        .company-grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>

  <body class="blog-revamp">
    <Header />
    <main>
      <article class="story-shell">
        <header class="story-hero">
          <div class="hero-copy">
            <div class="meta-row">
              <span class="meta-pill"><FormattedDate date={pubDate} /></span>
              {
                updatedDate && (
                  <span class="meta-pill">
                    Last updated on <FormattedDate date={updatedDate} />
                  </span>
                )
              }
            </div>
            <h1 class="story-title">{title}</h1>
          </div>
          {
            heroImage && (
              <figure class="hero-media">
                <img
                  width={1020}
                  height={610}
                  src={heroImage}
                  alt=""
                  loading="lazy"
                />
              </figure>
            )
          }
        </header>

        <div class="story-body">
          <slot />
        </div>
      </article>
    </main>
    <Footer />
  </body>
</html>
